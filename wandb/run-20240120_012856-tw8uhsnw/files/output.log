/home/david/anaconda3/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/david/anaconda3/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/david/anaconda3/lib/python3.11/site-packages/torch/nn/modules/conv.py:456: UserWarning: Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at /opt/conda/conda-bld/pytorch_1702400440653/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 1/6, loss: 0.8194
Epoch 1/6, loss: 0.9984
Epoch 1/6, loss: 2.7699
Epoch 1/6, loss: 4.4534
Epoch 1/6, loss: 2.5830
Epoch 1/6, loss: 0.6255
Epoch 1/6, loss: 0.2751
Epoch 1/6, loss: 0.1119
Epoch 1/6, loss: 0.0996
Epoch 1/6, loss: 0.0842
Epoch 1/6, loss: 0.0884
Epoch 1/6, loss: 0.0662
Epoch 1/6, loss: 0.0658
Epoch 1/6, loss: 0.0363
Epoch 1/6, loss: 0.0541
Epoch 1/6, loss: 0.0513
Epoch 1/6, loss: 0.0600
Epoch 1/6, loss: 0.0402
Epoch 1/6, loss: 0.0401
Epoch 1/6, loss: 0.0367
Epoch 1/6, loss: 0.0363
Epoch 1/6, loss: 0.0305
Epoch 1/6, loss: 0.0579
Epoch 1/6, loss: 0.0391
Epoch 1/6, loss: 0.0345
Epoch 1/6, loss: 0.0355
Epoch 1/6, loss: 0.0292
Epoch 1/6, loss: 0.0343
Epoch 1/6, loss: 0.0337
Epoch 1/6, loss: 0.0305
Epoch 1/6, loss: 0.0360
Epoch 1/6, loss: 0.0305
Epoch 1/6, loss: 0.0318
Epoch 1/6, loss: 0.0351
Epoch 1/6, loss: 0.0319
Epoch 1/6, loss: 0.0264
Epoch 1/6, loss: 0.0381
Epoch 1/6, loss: 0.0317
Epoch 1/6, loss: 0.0334
Epoch 1/6, loss: 0.0281
Epoch 1/6, loss: 0.0334
Epoch 1/6, loss: 0.0355
Epoch 1/6, loss: 0.0213
Epoch 1/6, loss: 0.0282
Epoch 1/6, loss: 0.0365
Epoch 1/6, loss: 0.0255
Epoch 1/6, loss: 0.0347
Epoch 1/6, loss: 0.0419
Epoch 1/6, loss: 0.0250
Epoch 1/6, loss: 0.0306
Epoch 1/6, loss: 0.0348
Epoch 1/6, loss: 0.0227
Epoch 1/6, loss: 0.0279
Epoch 1/6, loss: 0.0273
Epoch 1/6, loss: 0.0236
Epoch 1/6, loss: 0.0361
Epoch 1/6, loss: 0.0270
Epoch 1/6, loss: 0.0297
Epoch 1/6, loss: 0.0378
Epoch 1/6, loss: 0.0312
Epoch 1/6, loss: 0.0250
Epoch 1/6, loss: 0.0280
Epoch 1/6, loss: 0.0372
Epoch 1/6, loss: 0.0303
Epoch 1/6, loss: 0.0269
Epoch 1/6, loss: 0.0344
Epoch 1/6, loss: 0.0312
Epoch 1/6, loss: 0.0234
Epoch 1/6, loss: 0.0222
Epoch 1/6, loss: 0.0313
Epoch 1/6, loss: 0.0393
Epoch 1/6, loss: 0.0276
Epoch 1/6, loss: 0.0311
Epoch 1/6, loss: 0.0304
Epoch 1/6, loss: 0.0338
Epoch 1/6, loss: 0.0223
Epoch 1/6, loss: 0.0230
Epoch 1/6, loss: 0.0370
Epoch 1/6, loss: 0.0317
Epoch 1/6, loss: 0.0322
Epoch 1/6, loss: 0.0363
Epoch 1/6, loss: 0.0384
Epoch 1/6, loss: 0.0426
Epoch 1/6, loss: 0.0345
Epoch 1/6, loss: 0.0331
Epoch 1/6, loss: 0.0348
Epoch 1/6, loss: 0.0261
Epoch 1/6, loss: 0.0271
Epoch 1/6, loss: 0.0240
Epoch 1/6, loss: 0.0295
Epoch 1/6, loss: 0.0366
Epoch 1/6, loss: 0.0252
Epoch 1/6, loss: 0.0289
Epoch 1/6, loss: 0.0416
Epoch 1/6, loss: 0.0314
Epoch 1/6, loss: 0.0242
Epoch 1/6, loss: 0.0322
Epoch 1/6, loss: 0.0195
Epoch 1/6, loss: 0.0246
Epoch 1/6, loss: 0.0198
Epoch 1/6, loss: 0.0299
Epoch 1/6, loss: 0.0353
Epoch 1/6, loss: 0.0306
Epoch 1/6, loss: 0.0253
Epoch 1/6, loss: 0.0336
Epoch 1/6, loss: 0.0499
Epoch 1/6, loss: 0.0354
Epoch 1/6, loss: 0.0299
Epoch 1/6, loss: 0.0243
Epoch 1/6, loss: 0.0203
Epoch 1/6, loss: 0.0302
Epoch 1/6, loss: 0.0339
Epoch 1/6, loss: 0.0294
Epoch 1/6, loss: 0.0322
Epoch 1/6, loss: 0.0236
Epoch 1/6, loss: 0.0307
Epoch 1/6, loss: 0.0272
Epoch 1/6, loss: 0.0272
Epoch 1/6, loss: 0.0251
Epoch 1/6, loss: 0.0359
Epoch 1/6, loss: 0.0280
Epoch 1/6, loss: 0.0192
Epoch 1/6, loss: 0.0280
Epoch 1/6, loss: 0.0276
Epoch 1/6, loss: 0.0301
Epoch 1/6, loss: 0.0192
Epoch 1/6, loss: 0.0276
Epoch 1/6, loss: 0.0296
Epoch 1/6, loss: 0.0290
Epoch 1/6, loss: 0.0270
Epoch 1/6, loss: 0.0307
Epoch 1/6, loss: 0.0322
Epoch 1/6, loss: 0.0281
Epoch 1/6, loss: 0.0166
Epoch 1/6, loss: 0.0332
Epoch 1/6, loss: 0.0320
Epoch 1/6, loss: 0.0337
Epoch 1/6, loss: 0.0223
Epoch 1/6, loss: 0.0281
Epoch 1/6, loss: 0.0243
Epoch 1/6, loss: 0.0229
Epoch 1/6, loss: 0.0298
Epoch 1/6, loss: 0.0283
Epoch 1/6, loss: 0.0290
Epoch 1/6, loss: 0.0233
Epoch 1/6, loss: 0.0280
Epoch 1/6, loss: 0.0341
Epoch 1/6, loss: 0.0260
Epoch 1/6, loss: 0.0297
Epoch 1/6, loss: 0.0235
Epoch 1/6, loss: 0.0229
Epoch 1/6, loss: 0.0199
Epoch 1/6, loss: 0.0235
Epoch 1/6, loss: 0.0314
Epoch 1/6, loss: 0.0303
Epoch 1/6, loss: 0.0286
Epoch 1/6, loss: 0.0233
Epoch 1/6, loss: 0.0301
Epoch 1/6, Epoch loss: 0.1108, Val loss: 0.0476
Model checkpointed.
Epoch 2/6, loss: 0.0260
Epoch 2/6, loss: 0.0224
Epoch 2/6, loss: 0.0210
Epoch 2/6, loss: 0.0194
Epoch 2/6, loss: 0.0240
Epoch 2/6, loss: 0.0252
Epoch 2/6, loss: 0.0206
Epoch 2/6, loss: 0.0279
Epoch 2/6, loss: 0.0268
Epoch 2/6, loss: 0.0255
Epoch 2/6, loss: 0.0151
Epoch 2/6, loss: 0.0276
Epoch 2/6, loss: 0.0375
Epoch 2/6, loss: 0.0206
Epoch 2/6, loss: 0.0244
Epoch 2/6, loss: 0.0281
Epoch 2/6, loss: 0.0230
Epoch 2/6, loss: 0.0183
Epoch 2/6, loss: 0.0272
Epoch 2/6, loss: 0.0227
Epoch 2/6, loss: 0.0241
Epoch 2/6, loss: 0.0224
Epoch 2/6, loss: 0.0158
Epoch 2/6, loss: 0.0155
Epoch 2/6, loss: 0.0172
Epoch 2/6, loss: 0.0162
Epoch 2/6, loss: 0.0138
Epoch 2/6, loss: 0.0277
Epoch 2/6, loss: 0.0183
Epoch 2/6, loss: 0.0223
Epoch 2/6, loss: 0.0275
Epoch 2/6, loss: 0.0195
Epoch 2/6, loss: 0.0302
Epoch 2/6, loss: 0.0234
Epoch 2/6, loss: 0.0264
Epoch 2/6, loss: 0.0213
Epoch 2/6, loss: 0.0169
Epoch 2/6, loss: 0.0298
Epoch 2/6, loss: 0.0272
Epoch 2/6, loss: 0.0322
Epoch 2/6, loss: 0.0180
Epoch 2/6, loss: 0.0236
Epoch 2/6, loss: 0.0260
Epoch 2/6, loss: 0.0167
Epoch 2/6, loss: 0.0322
Epoch 2/6, loss: 0.0237
Epoch 2/6, loss: 0.0133
Epoch 2/6, loss: 0.0227
Epoch 2/6, loss: 0.0159
Epoch 2/6, loss: 0.0216
Epoch 2/6, loss: 0.0275
Epoch 2/6, loss: 0.0300
Epoch 2/6, loss: 0.0176
Epoch 2/6, loss: 0.0226
Epoch 2/6, loss: 0.0299
Epoch 2/6, loss: 0.0242
Epoch 2/6, loss: 0.0278
Epoch 2/6, loss: 0.0361
Epoch 2/6, loss: 0.0265
Epoch 2/6, loss: 0.0227
Epoch 2/6, loss: 0.0239
Epoch 2/6, loss: 0.0389
Epoch 2/6, loss: 0.0202
Epoch 2/6, loss: 0.0285
Epoch 2/6, loss: 0.0190
Epoch 2/6, loss: 0.0283
Epoch 2/6, loss: 0.0148
Epoch 2/6, loss: 0.0228
Epoch 2/6, loss: 0.0170
Epoch 2/6, loss: 0.0225
Epoch 2/6, loss: 0.0255
Epoch 2/6, loss: 0.0286
Epoch 2/6, loss: 0.0172
Epoch 2/6, loss: 0.0214
Epoch 2/6, loss: 0.0236
Epoch 2/6, loss: 0.0312
Epoch 2/6, loss: 0.0242
Epoch 2/6, loss: 0.0162
Epoch 2/6, loss: 0.0260
Epoch 2/6, loss: 0.0363
Epoch 2/6, loss: 0.0229
Epoch 2/6, loss: 0.0213
Epoch 2/6, loss: 0.0226
Epoch 2/6, loss: 0.0262
Epoch 2/6, loss: 0.0240
Epoch 2/6, loss: 0.0266
Epoch 2/6, loss: 0.0212
Epoch 2/6, loss: 0.0255
Epoch 2/6, loss: 0.0209
Epoch 2/6, loss: 0.0245
Epoch 2/6, loss: 0.0199
Epoch 2/6, loss: 0.0249
Epoch 2/6, loss: 0.0205
Epoch 2/6, loss: 0.0226
Epoch 2/6, loss: 0.0273
Epoch 2/6, loss: 0.0238
Epoch 2/6, loss: 0.0235
Epoch 2/6, loss: 0.0195
Epoch 2/6, loss: 0.0331
Epoch 2/6, loss: 0.0210
Epoch 2/6, loss: 0.0203
Epoch 2/6, loss: 0.0184
Epoch 2/6, loss: 0.0166
Epoch 2/6, loss: 0.0297
Epoch 2/6, loss: 0.0309
Epoch 2/6, loss: 0.0275
Epoch 2/6, loss: 0.0231
Epoch 2/6, loss: 0.0150
Epoch 2/6, loss: 0.0228
Epoch 2/6, loss: 0.0292
Epoch 2/6, loss: 0.0218
Epoch 2/6, loss: 0.0215
Epoch 2/6, loss: 0.0214
Epoch 2/6, loss: 0.0297
Epoch 2/6, loss: 0.0207
Epoch 2/6, loss: 0.0133
Epoch 2/6, loss: 0.0242
Epoch 2/6, loss: 0.0241
Epoch 2/6, loss: 0.0232
Epoch 2/6, loss: 0.0134
Epoch 2/6, loss: 0.0209
Epoch 2/6, loss: 0.0284
Epoch 2/6, loss: 0.0154
Epoch 2/6, loss: 0.0213
Epoch 2/6, loss: 0.0136
Epoch 2/6, loss: 0.0214
Epoch 2/6, loss: 0.0236
Epoch 2/6, loss: 0.0255
Epoch 2/6, loss: 0.0164
Epoch 2/6, loss: 0.0158
Epoch 2/6, loss: 0.0189
Epoch 2/6, loss: 0.0205
Epoch 2/6, loss: 0.0141
Epoch 2/6, loss: 0.0214
Epoch 2/6, loss: 0.0203
Epoch 2/6, loss: 0.0185
Epoch 2/6, loss: 0.0190
Epoch 2/6, loss: 0.0208
Epoch 2/6, loss: 0.0220
Epoch 2/6, loss: 0.0174
Epoch 2/6, loss: 0.0180
Epoch 2/6, loss: 0.0236
Epoch 2/6, loss: 0.0166
Epoch 2/6, loss: 0.0148
Epoch 2/6, loss: 0.0248
Epoch 2/6, loss: 0.0179
Epoch 2/6, loss: 0.0207
Epoch 2/6, loss: 0.0123
Epoch 2/6, loss: 0.0246
Epoch 2/6, loss: 0.0176
Epoch 2/6, loss: 0.0258
Epoch 2/6, loss: 0.0216
Epoch 2/6, loss: 0.0258
Epoch 2/6, loss: 0.0193
Epoch 2/6, loss: 0.0199
Epoch 2/6, loss: 0.0251
Epoch 2/6, loss: 0.0207
Epoch 2/6, loss: 0.0240
Epoch 2/6, Epoch loss: 0.0227, Val loss: 0.1267
Epoch 3/6, loss: 0.0185
Epoch 3/6, loss: 0.0207
Epoch 3/6, loss: 0.0246
Epoch 3/6, loss: 0.0280
Epoch 3/6, loss: 0.0279
Epoch 3/6, loss: 0.0177
Epoch 3/6, loss: 0.0186
Epoch 3/6, loss: 0.0221
Epoch 3/6, loss: 0.0155
Epoch 3/6, loss: 0.0159
Epoch 3/6, loss: 0.0149
Epoch 3/6, loss: 0.0207
Epoch 3/6, loss: 0.0162
Epoch 3/6, loss: 0.0228
Epoch 3/6, loss: 0.0237
Epoch 3/6, loss: 0.0187
Epoch 3/6, loss: 0.0204
Epoch 3/6, loss: 0.0153
Epoch 3/6, loss: 0.0242
Epoch 3/6, loss: 0.0224
Epoch 3/6, loss: 0.0144
Epoch 3/6, loss: 0.0221
Epoch 3/6, loss: 0.0159
Epoch 3/6, loss: 0.0177
Epoch 3/6, loss: 0.0133
Epoch 3/6, loss: 0.0206
Epoch 3/6, loss: 0.0239
Epoch 3/6, loss: 0.0173
Epoch 3/6, loss: 0.0149
Epoch 3/6, loss: 0.0130
Epoch 3/6, loss: 0.0265
Epoch 3/6, loss: 0.0186
Epoch 3/6, loss: 0.0234
Epoch 3/6, loss: 0.0173
Traceback (most recent call last):
  File "/home/david/projects/bone_age_cnn/train.py", line 199, in <module>
    main()
  File "/home/david/projects/bone_age_cnn/train.py", line 180, in main
    train_model(
  File "/home/david/projects/bone_age_cnn/train.py", line 95, in train_model
    for inputs, labels in train_dataloader:
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 674, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 364, in __getitems__
    return [self.dataset[self.indices[idx]] for idx in indices]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 364, in <listcomp>
    return [self.dataset[self.indices[idx]] for idx in indices]
            ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/david/projects/bone_age_cnn/dataset.py", line 25, in __getitem__
    image = self.transform(image)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 361, in forward
    return F.resize(img, self.size, self.interpolation, self.max_size, self.antialias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torchvision/transforms/functional.py", line 490, in resize
    return F_pil.resize(img, size=output_size, interpolation=pil_interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/torchvision/transforms/_functional_pil.py", line 250, in resize
    return img.resize(tuple(size[::-1]), interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.11/site-packages/PIL/Image.py", line 2156, in resize
    self.load()
  File "/home/david/anaconda3/lib/python3.11/site-packages/PIL/ImageFile.py", line 269, in load
    n, err_code = decoder.decode(b)
                  ^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Epoch 3/6, loss: 0.0198